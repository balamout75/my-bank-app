# ๐ฆ My Bank โ Sprint Project (Yandex Practicum)

# ะะพะผะฐัะฝัั ัะฐะฑะพัะฐ ะบ ะดะตะฒััะพะผั ัะฟัะธะฝัั ะบัััะฐ Java Middle Developer (Yandex Practicum)

---

# ะะฑัะฐั ะธะฝัะพัะผะฐัะธั

ะัะพะตะบั ะฟัะตะดััะฐะฒะปัะตั ัะพะฑะพะน **ะผะธะบัะพัะตัะฒะธัะฝะพะต ะฟัะธะปะพะถะตะฝะธะต ยซะะฐะฝะบยป**, ัะตะฐะปะธะทะพะฒะฐะฝะฝะพะต ะฝะฐ ะฑะฐะทะต Spring Boot ะธ Spring Cloud.

ะกะธััะตะผะฐ ัะพััะพะธั ะธะท ัะปะตะดัััะธั ัะตัะฒะธัะพะฒ:

| ะกะตัะฒะธั | ะะฐะทะฝะฐัะตะฝะธะต |
|--------|------------|
| **Front UI** | ะะตะฑ-ะธะฝัะตััะตะนั ะฟะพะปัะทะพะฒะฐัะตะปั |
| **Accounts Service** | ะะบะบะฐัะฝัั ะฟะพะปัะทะพะฒะฐัะตะปะตะน ะธ ะฑะฐะปะฐะฝั |
| **Cash Service** | ะะพะฟะพะปะฝะตะฝะธะต ะธ ัะฝััะธะต ััะตะดััะฒ |
| **Transfer Service** | ะะตัะตะฒะพะดั ะผะตะถะดั ะฟะพะปัะทะพะฒะฐัะตะปัะผะธ |
| **Notifications Service** | ะฃะฒะตะดะพะผะปะตะฝะธั (Outbox / Event Store) |
| **Gateway** | API Gateway |
| **Config Server** | ะฆะตะฝััะฐะปะธะทะพะฒะฐะฝะฝะฐั ะบะพะฝัะธะณััะฐัะธั |
| **Eureka** | Service Discovery |
| **Keycloak** | ะััะตะฝัะธัะธะบะฐัะธั ะธ ัะพะปะธ |
| **PostgreSQL** | ะฅัะฐะฝะตะฝะธะต ะดะฐะฝะฝัั |

ะััะธัะตะบัััะฐ ัะพะพัะฒะตัััะฒัะตั ะผะธะบัะพัะตัะฒะธัะฝะพะผั ะฟะพะดัะพะดั ะธ ะธัะฟะพะปัะทัะตั RESTโะฒะทะฐะธะผะพะดะตะนััะฒะธะต ะผะตะถะดั ัะตัะฒะธัะฐะผะธ.

---

# ๐งญ ะะธัะฝัะน ัะตัะฝะธัะตัะบะธะน ะบะพะฝัะตะบัั

ะ ะดะฐะฝะฝะพะน ัะฐะฑะพัะต ั ัะพะทะฝะฐัะตะปัะฝะพ ะฒััะตะป ะธะท ะทะพะฝั ะบะพะผัะพััะฐ:

- ะัะพะตะบั ัะตะฐะปะธะทะพะฒะฐะฝ ะฝะฐ **Maven**, ะฑะตะท ะธัะฟะพะปัะทะพะฒะฐะฝะธั Gradle
- ะัะฟะพะปัะทัะตััั **ะบะปะฐััะธัะตัะบะธะน Spring MVC**, ะฑะตะท WebFlux

ะะพัะปะต ะฟัะตะดัะดััะธั ะฟัะพะตะบัะพะฒ ะฝะฐ Gradle ะธ WebFlux ั ะพัััะธะป ัะฐะทะฝะธัั ะฒ ะปะฐะบะพะฝะธัะฝะพััะธ ะบะพะฝัะธะณััะฐัะธะน, ะณะธะฑะบะพััะธ ัะฑะพัะบะธ ะธ ะฒััะฐะทะธัะตะปัะฝะพััะธ ัะตะฐะบัะธะฒะฝะพะณะพ ััะธะปั. ะขะตะผ ะฝะต ะผะตะฝะตะต, ัะฐะฑะพัะฐ ะฟะพะทะฒะพะปะธะปะฐ ะณะปัะฑะถะต ะฟะพะฝััั ััััะพะนััะฒะพ Spring Boot ะฒ ะฑะพะปะตะต ััะฐะดะธัะธะพะฝะฝะพะผ (servlet) ััะตะบะต.

---

# ๐ ะะตะทะพะฟะฐัะฝะพััั

ะัะฟะพะปัะทัะตััั:

- OAuth 2.0
- OpenID Connect
- Keycloak (Docker)

### ะััะตะฝัะธัะธะบะฐัะธั ะฟะพะปัะทะพะฒะฐัะตะปะตะน
ะะพะปัะทะพะฒะฐัะตะปั ะฒัะพะดะธั ัะตัะตะท Keycloak. JWT access token ะธัะฟะพะปัะทัะตััั ะดะปั ะดะพัััะฟะฐ ะบ ัะตัะฒะธัะฐะผ.

### ะะตะถัะตัะฒะธัะฝะพะต ะฒะทะฐะธะผะพะดะตะนััะฒะธะต
ะกะตัะฒะธัั ะฒะทะฐะธะผะพะดะตะนััะฒััั ัะตัะตะท **client_credentials** flow.  
ะะฐะถะดัะน ัะตัะฒะธั ะฒััััะฟะฐะตั ะบะฐะบ OAuth2 client ะธ Resource Server ะพะดะฝะพะฒัะตะผะตะฝะฝะพ.

---

# ๐ณ Docker-ััะตะฝะด

ะะพะดะฝะธะผะฐัััั ะบะพะฝัะตะนะฝะตัั:

```
frontend
accounts-service
cash-service
transfer-service
notifications-service
gateway
config-server
eureka
postgres
keycloak
nginx
ngrok
```

---

# ๐ฆ ะกะตัะฒะธัั

## ๐ง Accounts Service

| ะะตัะพะด | URL | ะะฟะธัะฐะฝะธะต |
|------|-----|----------|
| GET | `/accounts/me` | ะัะพัะธะปั ะฟะพะปัะทะพะฒะฐัะตะปั |
| PUT | `/accounts/me` | ะะฑะฝะพะฒะปะตะฝะธะต ะฟัะพัะธะปั |
| GET | `/accounts/all` | ะกะฟะธัะพะบ ะดััะณะธั ะฟะพะปัะทะพะฒะฐัะตะปะตะน |
| POST | `/accounts/balance` | ะะทะผะตะฝะตะฝะธะต ะฑะฐะปะฐะฝัะฐ (ะฒะฝัััะตะฝะฝะธะน) |
| POST | `/accounts/transfer` | ะะฑัะฐะฑะพัะบะฐ ะฟะตัะตะฒะพะดะฐ (consume) |

---

## ๐ฐ Cash Service

| ะะตัะพะด | URL | ะะฟะธัะฐะฝะธะต |
|------|-----|----------|
| GET | `/cash/operation-key` | ะะพะปััะธัั idempotency ะบะปัั |
| POST | `/cash/operate` | ะะพะฟะพะปะฝะตะฝะธะต / ัะฝััะธะต |

---

## ๐ Transfer Service

| ะะตัะพะด | URL | ะะฟะธัะฐะฝะธะต |
|------|-----|----------|
| GET | `/transfer/operation-key` | ะะพะปััะธัั idempotency ะบะปัั |
| POST | `/transfer/transfer` | ะัะฟะพะปะฝะธัั ะฟะตัะตะฒะพะด |

---

## ๐ Notifications Service

| ะะตัะพะด | URL | ะะฟะธัะฐะฝะธะต |
|------|-----|----------|
| POST | `/notifications` | ะกะพะทะดะฐัั ัะฒะตะดะพะผะปะตะฝะธะต |

ะัะพะฑะตะฝะฝะพััะธ:
- ะัะฒะตั: **202 Accepted**
- Idempotency ัะตัะตะท `(service, operation_id)`
- ะฅัะฐะฝะตะฝะธะต JSON payload

---

# ๐ค ะะตะผะพะฝัััะฐัะธะพะฝะฝัะต ััะตัะฝัะต ะทะฐะฟะธัะธ

ะะปั ะฟัะพะฒะตัะบะธ ัะฐะฑะพัั ัะธััะตะผั ะฒ Keycloak ะทะฐะฒะตะดะตะฝั ะฟะพะปัะทะพะฒะฐัะตะปะธ:

| ะะพะปัะทะพะฒะฐัะตะปั | ะะพะณะธะฝ     | ะะฐัะพะปั |
|--------------|-----------|--------|
| ะะปะธะตะฝั 1 | **Alice** | alice |
| ะะปะธะตะฝั 2 | **Bob**  | bob |

ะญัะธ ััะตัะฝัะต ะทะฐะฟะธัะธ ะธัะฟะพะปัะทััััั ะดะปั ะฟัะพะฒะตัะบะธ ะฟะตัะตะฒะพะดะพะฒ, ะพะฟะตัะฐัะธะน ั ะฑะฐะปะฐะฝัะพะผ ะธ ัะฐะฑะพัั ะผะตะถัะตัะฒะธัะฝัั ััะตะฝะฐัะธะตะฒ.

---

# โ ะกะฑะพัะบะฐ (ะฒ ะบะพัะฝะตะฒะพะผ ะฟัะพะตะบัะต)

```
mvn clean package -DskipTests
```

---

# ๐ ะะฐะฟััะบ (ะฒ ะบะพัะฝะตะฒะพะผ ะฟัะพะตะบัะต)

```bash
docker compose --env-file docker-compose.env up -d --build
```

---

# ๐ ะััะธัะตะบัััะฐ (ััะตะผะฐ)

ะะธะถะต โ ัะฟัะพััะฝะฝะฐั ััะตะผะฐ ะฒะทะฐะธะผะพะดะตะนััะฒะธั ะบะพะผะฟะพะฝะตะฝัะพะฒ ะฒ docker-ััะตะฝะดะต:

```text
                   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                   โ                 Browser / User             โ
                   โโโโโโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโ
                                              โ
                                              โผ
                                     โโโโโโโโโโโโโโโโโโโ
                                     โ    Nginx (gw)   โ
                                     โ  reverse proxy  โ
                                     โโโโโโโโโฌโโโโโโโโโโ
                                             โ  /mybank/*
                                             โผ
                                     โโโโโโโโโโโโโโโโโโโ
                                     โ     Front UI    โ
                                     โ  (web, 8081)    โ
                                     โโโโโโโโโฌโโโโโโโโโโ
                                             โ REST calls (JWT)
                                             โผ
                                     โโโโโโโโโโโโโโโโโโโ
                                     โ Gateway Service โ
                                     โ  (edge API)     โ
                                     โโโโโโโโโฌโโโโโโโโโโ
                                             โ routes by service
                   โโโโโโโโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโโ
                   โ                         โ                         โ
                   โผ                         โผ                         โผ
          โโโโโโโโโโโโโโโโโโโโ       โโโโโโโโโโโโโโโโโโโ       โโโโโโโโโโโโโโโโโโโ
          โ Accounts Service โ       โ   Cash Service  โ       โ Transfer Serviceโ
          โ /accounts/*      โ       โ /cash/*         โ       โ /transfer/*     โ
          โโโโโโโโโฌโโโโโโโโโโโ       โโโโโโโโฌโโโโโโโโโโโ       โโโโโโโโโฌโโโโโโโโโโ
                  โ                         โ                          โ
                  โ (service-to-service)    โ (service-to-service)     โ (service-to-service)
                  โ OAuth2 client_credentials (JWT, roles)             โ
                  โโโโโโโโโโโโโโโโโฌโโโโโโโโโโดโโโโโโโโโโฌโโโโโโโโโโโโโโโโโ
                                  โผ                   โผ
                         โโโโโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                         โ Notifications   โ  โ PostgreSQL               โ
                         โ Service         โ  โ schemas: accounts/cash/  โ
                         โ /notifications  โ  โ transfer/notifications   โ
                         โโโโโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโ

      โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
      โ Eureka (discovery)           โ  โ service registration
      โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

      โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
      โ Config Server                โ  โ centralized config
      โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

      โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
      โ Keycloak                     โ  โ OAuth2/OIDC issuer (JWT)
      โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

      โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
      โ Ngrok          )             โ  โ public domain โ Nginx ((ะดะปั ะฐะฒัะพัะธะทะฐัะธะธ ะฒ Docker)
      โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

ะะปััะตะฒัะต ะฟัะธะฝัะธะฟั:
- ะฒะฝะตัะฝะธะต ะทะฐะฟัะพัั ะธะดัั ัะตัะตะท **Nginx โ Front UI โ Gateway**
- ัะตัะฒะธัั ัะตะณะธัััะธัััััั ะฒ **Eureka** ะธ ะฟะพะปััะฐัั ะบะพะฝัะธะณััะฐัะธั ะธะท **Config Server**
- ะฑะตะทะพะฟะฐัะฝะพััั ะพะฑะตัะฟะตัะธะฒะฐะตััั **Keycloak** (JWT, roles)
- ะฐัะธะฝััะพะฝะฝัะต ัะฒะตะดะพะผะปะตะฝะธั ัะตะฐะปะธะทะพะฒะฐะฝั ัะตัะตะท **Notifications Service (Outbox)**
- ะธะทะพะปััะธั ะดะฐะฝะฝัั โ ัะตัะตะท **ััะตะผั PostgreSQL** (ะฟะพ ัะตัะฒะธัั)

# ๐ Flow ะพะฟะตัะฐัะธะน

ะะธะถะต ะฟัะธะฒะตะดะตะฝั ะดะฒะฐ ะพัะฝะพะฒะฝัั ะฑะธะทะฝะตั-ััะตะฝะฐัะธั ะฝะฐ ััะพะฒะฝะต API ะธ ะผะตะถัะตัะฒะธัะฝัั ะฒัะทะพะฒะพะฒ.

## 1) ะะพะฟะพะปะฝะตะฝะธะต / ัะฝััะธะต (deposit / withdraw)

**ะฆะตะปั:** ะธะทะผะตะฝะธัั ะฑะฐะปะฐะฝั ะฟะพะปัะทะพะฒะฐัะตะปั ะธ ะทะฐัะธะบัะธัะพะฒะฐัั ะพะฟะตัะฐัะธั ั ะทะฐัะธัะพะน ะพั ะฟะพะฒัะพัะพะฒ (idempotency).

### ะจะฐะณะธ

1. **ะะพะปััะตะฝะธะต ะบะปััะฐ ะพะฟะตัะฐัะธะธ (idempotency key)**
    - ะะปะธะตะฝั ะฒัะทัะฒะฐะตั:
        - `GET /cash/operation-key`
    - ะ ะพัะฒะตั ะฟะพะปััะฐะตั `operationId` (ะบะปัั ะพะฟะตัะฐัะธะธ).

2. **ะัะฟะพะปะฝะตะฝะธะต ะพะฟะตัะฐัะธะธ ะฟะพะฟะพะปะฝะตะฝะธั/ัะฝััะธั**
    - ะะปะธะตะฝั ะฒัะทัะฒะฐะตั:
        - `POST /cash/operate`
    - ะขะตะปะพ ะทะฐะฟัะพัะฐ ัะพะดะตัะถะธั `operationId` ะธ ะฟะฐัะฐะผะตััั ะพะฟะตัะฐัะธะธ (ัะธะฟ, ััะผะผะฐ ะธ ั.ะฟ.).
    - Cash Service ัะพััะฐะฝัะตั ะพะฟะตัะฐัะธั ะฒ ัะฒะพะตะน ััะตะผะต ะะ ะธ ะธะฝะธัะธะธััะตั ะธะทะผะตะฝะตะฝะธะต ะฑะฐะปะฐะฝัะฐ.

3. **ะะทะผะตะฝะตะฝะธะต ะฑะฐะปะฐะฝัะฐ ะฒ Accounts Service**
    - Cash Service ะฒัะทัะฒะฐะตั **Accounts Service** (ะฒะฝัััะตะฝะฝะธะน endpoint):
        - `POST /accounts/balance`
    - ะัะทะพะฒ ะฒัะฟะพะปะฝัะตััั ั ัะตัะฒะธัะฝัะผ JWT (client_credentials).
    - Accounts Service ะฟัะธะผะตะฝัะตั ะธะทะผะตะฝะตะฝะธะต ะฑะฐะปะฐะฝัะฐ ั ััััะพะผ ะธะดะตะผะฟะพัะตะฝัะฝะพััะธ (ะฝะฐะฟัะธะผะตั, ัะตัะตะท `service_operations`).

4. **ะคะพัะผะธัะพะฒะฐะฝะธะต ัะฒะตะดะพะผะปะตะฝะธั**
    - ะกะตัะฒะธั ะธะฝะธัะธะฐัะพั (Cash) ะฒัะทัะฒะฐะตั:
        - `POST /notifications`
    - ะ Notifications Service ัะพะทะดะฐัััั ะทะฐะฟะธัั (Outbox) ั ะบะปััะพะผ `(service, operation_id)` ะธ JSON payload.

### ะะดะตะผะฟะพัะตะฝัะฝะพััั
- ะบะปัั ะพะฟะตัะฐัะธะธ ัะพะทะดะฐัััั ะทะฐัะฐะฝะตะต (`/cash/operation-key`)
- ะฟะพะฒัะพัะฝัะน ะฒัะทะพะฒ ั ัะตะผ ะถะต `(service, operation_id)` ะฝะต ะดะพะปะถะตะฝ ะฟัะธะฒะพะดะธัั ะบ ะดะฒะพะนะฝะพะผั ัะฟะธัะฐะฝะธั/ะทะฐัะธัะปะตะฝะธั
- Notifications ัะฐะบะถะต ะทะฐัะธััะฝ ะพั ะดัะฑะปะตะน ัะพััะฐะฒะฝัะผ ะบะปััะพะผ

---

## 2) ะะตัะตะฒะพะด ะผะตะถะดั ะฟะพะปัะทะพะฒะฐัะตะปัะผะธ (transfer)

**ะฆะตะปั:** ัะฟะธัะฐัั ััะตะดััะฒะฐ ั ะพัะฟัะฐะฒะธัะตะปั ะธ ะทะฐัะธัะปะธัั ะฟะพะปััะฐัะตะปั, ะทะฐัะธะบัะธัะพะฒะฐัั ะพะฟะตัะฐัะธั ะธ ัะฒะตะดะพะผะปะตะฝะธั.

### ะจะฐะณะธ

1. **ะะพะปััะตะฝะธะต ะบะปััะฐ ะพะฟะตัะฐัะธะธ**
    - ะะปะธะตะฝั ะฒัะทัะฒะฐะตั:
        - `GET /transfer/operation-key`
    - ะะพะปััะฐะตั `operationId`.

2. **ะกะพะทะดะฐะฝะธะต ะพะฟะตัะฐัะธะธ ะฟะตัะตะฒะพะดะฐ**
    - ะะปะธะตะฝั ะฒัะทัะฒะฐะตั:
        - `POST /transfer/transfer`
    - Transfer Service ัะพััะฐะฝัะตั ะพะฟะตัะฐัะธั ะฟะตัะตะฒะพะดะฐ ะฒ ัะฒะพะตะน ััะตะผะต ะะ ะธ ะธะฝะธัะธะธััะตั ะธะทะผะตะฝะตะฝะธั ะฑะฐะปะฐะฝัะพะฒ.

3. **ะะทะผะตะฝะตะฝะธะต ะฑะฐะปะฐะฝัะพะฒ (ะผะตะถัะตัะฒะธัะฝะพ)**
    - Transfer Service ะฒัะทัะฒะฐะตั Accounts Service (ะฒะฝัััะตะฝะฝะธะน endpoint):
        - `POST /accounts/transfer`
    - ะัะทะพะฒ ะธะดัั ั ัะตัะฒะธัะฝัะผ JWT (client_credentials).
    - Accounts Service ะฒัะฟะพะปะฝัะตั ัะฟะธัะฐะฝะธะต/ะทะฐัะธัะปะตะฝะธะต ะธ ัะธะบัะธััะตั ัะฐะบั ะฟัะธะผะตะฝะตะฝะธั (idempotency).

4. **ะฃะฒะตะดะพะผะปะตะฝะธะต**
    - ะกะตัะฒะธั ะธะฝะธัะธะฐัะพั (Transfer) ะฒัะทัะฒะฐะตั:
        - `POST /notifications`
    - ะ Outbox ัะพััะฐะฝัะตััั JSON payload ะธ ะฒัััะฐะฒะปัะตััั ััะฐััั ะดะพััะฐะฒะบะธ.

### ะะดะตะผะฟะพัะตะฝัะฝะพััั
- ะฟะพะฒัะพัะฝัะน ะทะฐะฟัะพั ั ัะตะผ ะถะต `operationId` ะดะพะปะถะตะฝ ััะธัะฐัััั ะดัะฑะปะตะผ
- ะบะปัั ัะฝะธะบะฐะปัะฝะพััะธ: `(service, operation_id)`
- ััะพ ะฟะพะทะฒะพะปัะตั ะฑะตะทะพะฟะฐัะฝะพ ะฟัะธะผะตะฝััั Retry ะฟัะธ ะพัะธะฑะบะฐั ัะตัะธ/ะฒัะตะผะตะฝะฝะพะน ะฝะตะดะพัััะฟะฝะพััะธ

---

## ะะฐะถะฝะพ ะฟัะพ SAGA (ะฟะตััะฟะตะบัะธะฒะฐ ัะฐะทะฒะธัะธั)

ะะตัะตะฒะพะด ะดะตะฝะตะณ ะตััะตััะฒะตะฝะฝัะผ ะพะฑัะฐะทะพะผ ัะบะปะฐะดัะฒะฐะตััั ะฒ ะฟะฐััะตัะฝ **SAGA**.  
ะ ัะตะบััะตะน ะฒะตััะธะธ ะฟะตัะตะฒะพะด ะฒัะณะปัะดะธั ะบะฐะบ ะตะดะธะฝะฐั ัะตะฟะพัะบะฐ ะฒัะทะพะฒะพะฒ, ะพะดะฝะฐะบะพ ะฒ ัะปะตะดัััะธั ะธัะตัะฐัะธัั ะปะพะณะธัะฝะพ:
- ัะฐะทะดะตะปะธัั ะฟะตัะตะฒะพะด ะฝะฐ 2 ะฝะตะทะฐะฒะธัะธะผัั ัะฐะณะฐ (debit/credit)
- ะดะพะฑะฐะฒะธัั ะบะพะผะฟะตะฝัะฐัะธะธ
- ัะตะฐะปะธะทะพะฒะฐัั ัะพัะตะพะณัะฐัะธัะตัะบัั SAGA ะดะปั ัััะพะนัะธะฒะพััะธ ัะฐัะฟัะตะดะตะปัะฝะฝะพะน ััะฐะฝะทะฐะบัะธะธ

---


# ๐ง ะะตะฐะปะธะทะฐัะธั ะธ ะพะฟัั

### ะัะฝะพะฒะฝัะต ัะตัะฝะธัะตัะบะธะต ัะตัะตะฝะธั

#### Idempotency
ะัะฟะพะปัะทัะตััั ัะพััะฐะฒะฝะพะน ะบะปัั `(service, operation_id)` ะดะปั ะทะฐัะธัั ะพั ะฟะพะฒัะพัะฝะพะน ะพะฑัะฐะฑะพัะบะธ.

#### Notifications ะบะฐะบ Outbox
ะกะตัะฒะธั ัะฒะตะดะพะผะปะตะฝะธะน ััะฐะฝะธั ัะพะฑััะธั, ััะฐััั ะดะพััะฐะฒะบะธ, ะฟะพะฟััะบะธ ะธ ะพัะธะฑะบะธ.

#### OAuth2 ะฝะฐ ััะพะฒะฝะต ัะตัะฒะธัะพะฒ
ะะฐะถะดัะน ัะตัะฒะธั โ Resource Server + OAuth2 Client.

#### Circuit Breaker ะธ Retry
ะัะฟะพะปัะทัะตััั Resilience4j ะดะปั ัััะพะนัะธะฒะพััะธ ะผะตะถัะตัะฒะธัะฝัั ะฒัะทะพะฒะพะฒ.

#### Multi-schema Postgres
ะะฐะถะดัะน ัะตัะฒะธั ะธัะฟะพะปัะทัะตั ัะพะฑััะฒะตะฝะฝัั ััะตะผั:

```
accounts
cash
transfer
notifications
```

#### Docker ะธ multi-module ัะฑะพัะบะฐ
ะะฐัััะพะนะบะฐ ัะฑะพัะบะธ multi-module Maven ะฟัะพะตะบัะฐ ะฒะฝัััะธ Docker ั ะบะตัะธัะพะฒะฐะฝะธะตะผ ะทะฐะฒะธัะธะผะพััะตะน.

---

# ๐ ะัะพะณะธ

ะัะพะตะบั ะฟะพะทะฒะพะปะธะป ะฝะฐ ะฟัะฐะบัะธะบะต ัะฐะทะพะฑัะฐัััั ั:

- OAuth2 / JWT
- Keycloak ะฒ Docker-ัะตัะธ
- Outbox-ะฟะฐััะตัะฝะพะผ
- Idempotency
- Resilience4j
- Liquibase
- ะะธะบัะพัะตัะฒะธัะฝะพะน ะฐััะธัะตะบัััะพะน

---

# ๐ง ะฆะตะปะธ, ะบะพัะพััะต ััะฐะปะธ ะพัะตะฒะธะดะฝั, ะฝะพ ะฝะต ะฑัะปะธ ะดะพะฒะตะดะตะฝั ะดะพ ัะตะฐะปะธะทะฐัะธะธ

ะะฐะฑะพัะฐ ะฝะฐะด ะฟัะพะตะบัะพะผ ะฟะพะทะฒะพะปะธะปะฐ ะฒััะฒะธัั ะฝะฐะฟัะฐะฒะปะตะฝะธั, ััะตะฑัััะธะต ะดะฐะปัะฝะตะนัะตะณะพ ัะฐะทะฒะธัะธั.

### 1. Transfer Service ะบะฐะบ SAGA

ะกะตัะฒะธั ะฟะตัะตะฒะพะดะพะฒ ะฟะพ ัะฒะพะตะน ะฟัะธัะพะดะต ัะฒะปัะตััั ัะพัะพัะธะผ ะบะฐะฝะดะธะดะฐัะพะผ ะดะปั ัะตะฐะปะธะทะฐัะธะธ ะฟะฐััะตัะฝะฐ **SAGA**.  
ะขะตะบััะฐั ัะตะฐะปะธะทะฐัะธั ะพะฟะธัะฐะตััั ะฝะฐ ัะตะฝััะฐะปะธะทะพะฒะฐะฝะฝัั ะปะพะณะธะบั, ะพะดะฝะฐะบะพ ะฒ ัะปะตะดัััะตะน ัะฐะฑะพัะต ะฟะปะฐะฝะธััะตััั:

- ัะฐะทะดะตะปะธัั ะฟะตัะตะฒะพะด ะฝะฐ ะดะฒะต ะฝะตะทะฐะฒะธัะธะผัะต ััะฐะฝะทะฐะบัะธะธ
- ัะตะฐะปะธะทะพะฒะฐัั **ัะพัะตะพะณัะฐัะธัะตัะบัั SAGA**
- ะดะพะฑะธัััั ัััะพะนัะธะฒะพััะธ ัะฐัะฟัะตะดะตะปะตะฝะฝะพะน ััะฐะฝะทะฐะบัะธะธ ะฑะตะท ะฑะปะพะบะธัะพะฒะพะบ

---

### 2. ะกะฑะพัะบะฐ multi-module ะฟัะพะตะบัะฐ ะฒ Docker

ะะต ัะดะฐะปะพัั ะดะพะฒะตััะธ ะดะพ ะธะดะตะฐะปะฐ 2-stage Dockerfile ะดะปั ะผะฝะพะณะพะผะพะดัะปัะฝะพะณะพ Maven-ะฟัะพะตะบัะฐ.  
ะัะฝะพะฒะฝัะต ัะปะพะถะฝะพััะธ:

- ัะฐะฑะพัะฐ parent POM
- ะบััะธัะพะฒะฐะฝะธะต ะทะฐะฒะธัะธะผะพััะตะน
- ะพะฟัะธะผะธะทะฐัะธั ัะปะพัะฒ ะพะฑัะฐะทะฐ
- ัะพะณะปะฐัะพะฒะฐะฝะธะต Docker Compose ั multi-module ััััะบัััะพะน

ะญัะฐ ะทะฐะดะฐัะฐ ััะตะฑัะตั ะฑะพะปะตะต ะณะปัะฑะพะบะพะน ะฝะฐัััะพะนะบะธ BuildKit ะธ Maven cache-ัะปะพัะฒ.

---

### 3. ะะฑัะฐะฑะพัะบะฐ ะบะฐััะพะผะฝัั ะธัะบะปััะตะฝะธะน

ะะตัะฐะฝะธะทะผ ะฟัะพะฑัะพัะฐ ะฑะธะทะฝะตั-ะธัะบะปััะตะฝะธะน ะพั ััะพะฒะฝั ัะตัะฒะธัะพะฒ ะดะพ ะฟะพะปัะทะพะฒะฐัะตะปั ัะตะฐะปะธะทะพะฒะฐะฝ ัะฐััะธัะฝะพ.  
ะ ััะดะต ััะตะฝะฐัะธะตะฒ ะผะพะถะฝะพ ะฑัะปะพ:

- ะดะฐัั ะฑะพะปะตะต ัะพัะฝัะต ัะพะพะฑัะตะฝะธั
- ัะพััะฐะฝะธัั ะฑะพะปััะต ะดะธะฐะณะฝะพััะธัะตัะบะพะน ะธะฝัะพัะผะฐัะธะธ
- ััะฐะฝะดะฐััะธะทะธัะพะฒะฐัั error response

ะญัะพั ะฐัะฟะตะบั ะฟะปะฐะฝะธััะตััั ัะปัััะธัั ะฒ ัะปะตะดัััะธั ะฟัะพะตะบัะฐั.


# ะะฒัะพั

ะะฒะฐะฝ ะะฐัะธะปัะตะฒ
